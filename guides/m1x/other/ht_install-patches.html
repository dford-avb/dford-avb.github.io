---
layout: m1x
title: How to Apply and Revert Openmage Patches
---
	<!-- Title: How to Apply and Revert Openmage Patches -->
	<!-- URL: apply-revert-openmage-patches -->

	<h4 id="contents">Table of Contents</h4>
	<ul><li><a href="#overview">Overview</a></li>
		<li><a href="#detail">Need More Detail?</a></li>
		<li><a href="#get">How to Get Openmage Patches</a></li>
		<li><a href="#apply">How to Apply a Openmage Patch</a></li>
		<li><a href="#apply-8788">How to Apply the SUPEE-8788 Patch</a></li>
		<li><a href="#id">Listing Patches You Have Installed</a></li>
		<li><a href="#revert">How to Revert a Openmage Patch</a></li>
		<li><a href="#trouble">Troubleshooting</a></li></ul>

	<h2 id="overview">Overview</h2>
	<p>This article discusses how to apply and revert Openmage patches you get in any of the following ways:
	<ul><li>Openmage Support</li>
		<li>Openmage Enterprise Edition (EE) support portal</li>
		<li>(Openmage partners) from the <a href="https://partners.openmage.com" target="_blank">partner portal</a></li></ul>
	<p>If you don't already have a patch, <a href="http://support.openmagecommerce.com/" target="_blank">contact Openmage Support</a>.</p>
	<div class="msg-box important"><img src="{{ site.baseurl }}/guides/m1x/images/icon-note.png" alt="note" align="left" width="40"><span><strong>Note</strong>: This article assumes your patch file name ends in <code>.sh</code>. If your patch file name ends in <code>.patch</code> or something else, <a href="http://support.openmagecommerce.com/" target="_blank">contact Openmage Support</a> before proceeding.</div>

	<h2 id="detail">Need More Detail?</h2>
	<p>For more step-by-step details that are provided here, see one of the following:</p>
	<ul><li><a href="https://info.openmage.com/rs/openmagecommerce/images/Installing-a-Patch-for-Openmage-Community-Edition.pdf" target="_blank">Openmage CE patch instructions</a></li>
		<li><a href="https://info.openmage.com/rs/openmagecommerce/images/Installing-a-Patch-for-Openmage-Enterprise-Edition.pdf" target="_blank">Openmage EE patch instructions</a></li></ul>

	<h2 id="get">How to Get Openmage Patches</h2>
	<p>Openmage Support provides some patches for Openmage CE and EE on openmagecommerce.com. This section discusses how to get those patches.</p>
	<p>If Openmage Support provided a patch to you, skip this section and continue with <a href="#apply">How to Apply a Openmage Patch</a>.</p>
	<p>See one of the following sections for specific information about Openmage CE or EE:</p>
	<ul><li><a href="#get-ce">Getting Openmage CE Patches</a></li>
		<li><a href="#get-ee">Getting Openmage EE Patches</a></li></ul>

	<h3 id="get-ce">Getting Openmage CE Patches</h3>
	<p>To get patches for Openmage CE:</p>
	<ol><li>Log in to <a href="https://www.openmagecommerce.com/download" target="_blank">openmagecommerce.com/download</a>.<br />
		(Click <strong>My Account</strong> in the upper right corner of the page.)<br />
		If you don't have an account, you can register for one; the account is free.</li>
		<li>In the Openmage Community Edition Patches section, locate the patch to install.</li>
		<li>From the list next to the patch, choose your CE version.</li>
		<li>Click <strong>Download</strong>.</li>
		<li>After the patch downloads, continue with <a href="#apply">How to Apply a Openmage Patch</a>.</li></ol>

	<h3 id="get-ee">Getting Openmage EE Patches</h3>
	<p>To get patches for Openmage EE:</p>
	<ol><li>Log in to <a href="https://www.openmagecommerce.com" target="_blank">openmagecommerce.com</a>.<br />
		(Click <strong>My Account</strong> in the upper right corner of the page.)</li>
		<li>Click <strong>Downloads</strong> in the left pane.</li>
		<li>Click <strong>Openmage Enterprise Edition</strong> in the right pane.<br />
			The following figure shows an example.<br />
			<img src="{{ site.baseurl }}/guides/m1x/images/EE-spt-portal.png" height="554px" width="812px"></li>
		<li>Click <strong>Support Patches</strong>.</li>
		<li>Locate the patch to download.</li>
		<li>Click <strong>Download</strong> corresponding to the patch for the version of EE you're using.</li>
		<li>After the download completes, continue with the next section.</li></ol>

	<h2 id="apply">How to Apply a Openmage Patch</h2>
	<p>To apply a Openmage patch:</p>
	<ol><li>Transfer the patch <code>.sh</code> file to your Openmage installation root directory.<br />
		<div class="msg-box important"><img src="{{ site.baseurl }}/guides/m1x/images/icon-note.png" alt="note" align="left" width="40"><span><strong>Note</strong>: This article assumes your patch file name ends in <code>.sh</code>. If your patch file name ends in <code>.patch</code> or something else, <a href="http://support.openmagecommerce.com/" target="_blank">contact Openmage Support</a> before proceeding.</div>

		For example, <code>/var/www/html/openmage</code>.</li>
		<li>Enter the following commands as a user with sufficient privileges to write to Openmage files (typically, the web server user or <code>root</code>):
			<pre>chmod +x &lt;patch-file-name>.sh
./&lt;patch-file-name>.sh</pre>
			A message such as the following displays to confirm the patch installed successfully:
			<pre>Patch was applied/reverted successfully.</pre></li>
		<li>To reapply ownership to the files changed by the patch:
			<ol><li>Find the web server user: <code>ps -o "user group command" -C httpd,apache2</code><br />
				The value in the USER column is the web server username.<br />
				Typically, the Apache web server user on CentOS is <code>apache</code> and the Apache web server user on Ubuntu is <code>www-data</code>.</li>
				<li>As a user with <code>root</code> privileges, enter the following command from the Openmage installation directory:
					<pre>chown -R <em>web-server-user-name</em> .</pre>
					For example, on Ubuntu where Apache usually runs as <code>www-data</code>, enter
					<pre>chown -R www-data .</pre></li></ol>
		</li>
		<li>Perform any other tasks as instructed by Openmage Support.<br />
			(For example, some patches require you to stop external services, such as the Solr search engine.)</li></ol>

	<h2 id="apply-8788">How to Apply the SUPEE-8788 Patch</h2>
	<p>We released a <a href="https://openmage.com/security/patches/supee-8788" target="_blank">security patch</a> in October, 2016 that might cause issues for some users. This section applies to you if any of the following is true:</p>
	<ul><li>You haven't yet applied the SUPEE-8788 patch and your Openmage version is earlier than EE 1.14.1.0 or CE 1.9.1.0.</li>
		<li>You applied version 1 of the SUPEE-8788 patch. (The patch name includes <code>PATCH_SUPEE-8788_&lt;openmage version>_v1</code>.)</li>
		<li>You previously applied the SUPEE-1533 patch and you want to apply the SUPEE-8788 patch.</li>
		<li>You're applying the SUPEE-8788 patch as part of an upgrade from an earlier Openmage version.</li></ul>

	<p>We recommend the following:</p>
	<ul><li>If you applied SUPEE-8788 version 1, revert that patch, revert SUPEE-1533 (version restrictions apply), apply SUPEE-3941 (version restrictions apply), then <a href="#apply-8788-v1">apply SUPEE-8788 version 2 or later</a>. </li>
		<li>If you haven't applied SUPEE-8788, revert SUPEE-1533 (version restrictions apply), apply SUPEE-3941 (version restrictions apply), then <a href="#apply-8788-new">apply SUPEE-8788</a>.</li></ul>

	<h3 id="apply-8788-v1">Replace SUPEE-8788 version 1 with version 2 or later</h3>
	<p>To replace SUPEE-7877 version 1 with version 2 or later:</p>
	<ol><li>Log in to your Openmage server.</li>
		<li>Open <code>&lt;your Openmage install dir>/app/etc/applied.patches.list</code> in a text editor.<br><br>
			This file lists all currently applied patches.</li>
		<li>Determine which patches are already applied. Version 1 of SUPEE-8788 includes <code>PATCH_SUPEE-8788_&lt;openmage version>_v1</code> in the name.</li>
		<li>If your Openmage version is EE 1.14.1.0 or CE 1.9.1.0, <em>and</em> patch SUPEE-1533 is applied, <a href="#revert">revert</a> SUPEE-1533.</li>
		<li>If your Openmage version is earlier than EE 1.14.1.0 or CE 1.9.1.0, <em>and</em> SUPEE-3941 is not applied, <a href="#apply">apply SUPEE-3941</a>.</li>
		<li><a href="#get">Get</a> version 2 or later of SUPEE-8788.</li>
		<li><a href="#apply">Apply</a> version 2 or later of SUPEE-8788.</li>
		<li><em>Openmage EE 1.14.2 only</em>. After applying the SUPEE-8788 patch, remove <code>test_oauth.php</code> from your Openmage base directory.</li>
		<li>If you upgraded to Openmage CE 1.9.3 or Openmage EE 1.14.3 after applying the <a href="https://openmage.com/security/patches/supee-8788" target="_blank">SUPEE-8788 patch</a>, make sure the following files have been deleted:<br>

			<pre>skin/adminhtml/default/default/media/flex.swf
skin/adminhtml/default/default/media/uploader.swf
skin/adminhtml/default/default/media/uploaderSingle.swf</pre>

			If the files are present, delete them to avoid a potential security exploit. As of Openmage CE 1.9.0.0 and Openmage EE 1.14.0.0, we no longer distribute <code>.swf</code> files with the Openmage software.</li></ol>

	<h3 id="apply-8788-new">Apply SUPEE-8788</h3>
	<p>To apply patch SUPEE-8788:</p>
	<ol><li>Open <code>&lt;your Openmage install dir>/app/etc/applied.patches.list</code> in a text editor.<br><br>
		This file lists all currently applied patches.</li>
		<li>Verify SUPEE-8788 is <em>not</em> applied. If it is, and it's version 1, see <a href="#apply-8788-v1">Replace SUPEE-8788 version 1 with version 2 or later</a>.</li>
		<li>Verify whether or not patch SUPEE-1533 is applied. If it is, <em>and</em> your Openmage version is earlier than EE 1.14.1.0 or CE 1.9.1.0, <a href="#revert">revert</a> SUPEE-1533.</li>
		<li>If your Openmage version is earlier than EE 1.14.1.0 or CE 1.9.1.0, <em>and</em> SUPEE-3941 is not applied, <a href="#apply">apply SUPEE-3941</a>.</li>
		<li><a href="#get">Get</a> version 2 or later of SUPEE-8788.</li>
		<li><a href="#apply">Apply</a> version 2 or later of SUPEE-8788.</li>
		<li><em>Openmage EE 1.14.2 only</em>. After applying the SUPEE-8788 patch, remove <code>test_oauth.php</code> from your Openmage base directory.</li>
		<li>If you upgraded to Openmage CE 1.9.3 or Openmage EE 1.14.3 after applying the <a href="https://openmage.com/security/patches/supee-8788" target="_blank">SUPEE-8788 patch</a>, make sure the following files have been deleted:<br>

			<pre>skin/adminhtml/default/default/media/flex.swf
skin/adminhtml/default/default/media/uploader.swf
skin/adminhtml/default/default/media/uploaderSingle.swf</pre>

			If the files are present, delete them to avoid a potential security exploit. As of Openmage CE 1.9.0.0 and Openmage EE 1.14.0.0, we no longer distribute <code>.swf</code> files with the Openmage software.</li></ol>

	<h2 id="id">Listing Patches You Have Installed</h2>
	<p>If you're not sure which patches are already applied, open <code>&lt;your Openmage install dir>/app/etc/applied.patches.list</code>.</p>

	<h2 id="revert">How to Revert a Openmage Patch</h2>
	<p>If applying the patch results in errors, <a href="http://support.openmagecommerce.com/" target="_blank">contact Openmage Support</a>. If you are instructed to do so, revert the patch:</p>
	<ol><li>Change to your Openmage installation directory.</li>
		<li>Enter the following command as a user with sufficient privileges to write to Openmage files (typically, the web server user or <code>root</code>):<br />
			<pre>sh <em>patch-file-name</em>.sh -R</pre></li></ol>

	<h2 id="trouble">Troubleshooting</h2>
	<p>If you get an error when you run the patch, use the following suggestions:</p>
	<ul><li>Verify the patch is located in your Openmage installation root directory.<br />
		Ubuntu example: <code>/var/www/openmage</code><br />
		CentOS example: <code>/var/www/html/openmage</code></li>
		<li>Verify you're running the patch with sufficient privileges.<br />
			Typically, this means running it as the web server user or as a user with <code>root</code> privileges.</li>
		<li>Try running the patch again.<br />
			If problems persist, <a href="http://support.openmagecommerce.com/" target="_blank">contact Openmage Support</a>.</li>
	</ul>
